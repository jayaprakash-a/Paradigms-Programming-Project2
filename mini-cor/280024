Chapter 4 High-Dimensional Image Warping
 Abstract This chapter is about warping brain images of different subjects to the same stereotaxic space.  However, unlike Chapter 3, this method uses thousands or millions of parameters, so is potentially able to obtain much more precision.  A high dimensional 1 model is used, whereby a finite element approach is employed to estimate translations at the location of each voxel in the template image.  Bayesian statistics are used to obtain a maximum a posteriori (MAP) estimate of the deformation field.  The validity of any registration method is largely based upon the prior knowledge about the variability of the estimated parameters.  In this approach it is assumed that the priors should have some form of symmetry, in that priors describing the probability distribution of the deformations should be identical to those for the inverses (i. e. , warping brain A to brain B should not be different probabilistically from warping B to A).  The fundamental assumption is that the probability of stretching a voxel by a factor of n is considered to be the same as the probability of shrinking n voxels by a factor of n- 1 .  The penalty function of choice is based upon the logs of the singular values of the Jacobian matrices having normal distributions, which enforces a continuous one-to-one mapping.  A gradient descent algorithm is presented that incorporates the above priors in order to obtain a MAP estimate of the deformations.  Further consistency is achieved by registering images to their "averages", where this average is one of both intensity and shape.
