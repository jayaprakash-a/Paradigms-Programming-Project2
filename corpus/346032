Radiance Caching and Local Geometry Correction
 Abstract We present a final gather algorithm which splits the irradiance integral into two components.  One component captures the incident radiance on surfaces due to distant surfaces.  This incident radiance is represented as a spatially varying field of spherical harmonic coefficients.  Since distant surfaces do not cause rapid changes in incident radiance, this field is smooth and slowly varying and can be computed quickly and represented efficiently.  On the other hand, nearby surfaces may create drastic changes in irradiance, because their position on the visible hemisphere change quickly.  We correct the irradiance we obtain from spherical harmonics using an explicit representation of nearby geometry.  By assuming nearby geometry is always visible, we can efficiently restore the high frequency detail missing from the irradiance.  Current techniques need to sample the nearby surfaces densely to approximate this rapid change of irradiance.  This creates unnecessary visibility tests (or raytraces) that slow down the final gather.  We demonstrate that by assuming nearby surfaces are always visible, we obtain very fast final gather results whose quality compares well with standard techniques but is computed much faster.  We also demonstrate the feasibility of using nearby surfaces on scenes without global illumination to restore the high frequency shading detail due to geometric detail.
