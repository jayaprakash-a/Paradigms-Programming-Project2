Exact MAP estimates via agreement on (hyper)trees: Linear programming and message-passing approaches

