Structured importance sampling of environment maps
 Abstract We introduce structured importance sampling, a new technique for efficiently rendering scenes illuminated by distant natural illumination given in an environment map.  Our method handles occlusion, high-frequency lighting, and is significantly faster than alternative methods based on Monte Carlo sampling.  We achieve this speedup as a result of several ideas.  First, we present a new metric for stratifying and sampling an environment map taking into account both the illumination intensity as well as the expected variance due to occlusion within the scene.  We then present a novel hierarchical stratification algorithm that uses our metric to automatically stratify the environment map into regular strata.  This approach enables a number of rendering optimizations, such as pre-integrating the illumination within each stratum to eliminate noise at the cost of adding bias, and sorting the strata to reduce the number of sample rays.  We have rendered several scenes illuminated by natural lighting, and our results indicate that structured importance sampling is better than the best previous Monte Carlo techniques, requiring one to two orders of magnitude fewer samples for the same image quality.
