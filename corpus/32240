Adaptive sampling and mesh generation

